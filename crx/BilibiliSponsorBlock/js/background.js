(()=>{"use strict";var e={721:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentTTLCache=void 0;const o=i(9672);t.PersistentTTLCache=class{constructor(e,t,i=2e3,n=512e3){this.loaded=!1,this.loadingPromise=null,this.totalSizeBytes=0,this.operationQueue=Promise.resolve(),this.persistTimer=null,this.persistWaiters=[],this.firstPersistTime=null,this.cache={},this.dailyStats={date:(new Date).getDate().toString(),hits:0,sizeBytes:0},this.maxPersistWaitTime=3e4,this.normalDelay=5e3,this.storageKey="bsb_cache_"+e,this.ttlMs=t,this.maxEntries=i,this.maxSizeBytes=n,this.ensureLoaded()}ensureLoaded(){return n(this,void 0,void 0,(function*(){if(!this.loaded)return this.loadingPromise||(this.loadingPromise=(()=>n(this,void 0,void 0,(function*(){console.debug("loading",this.storageKey);const e=yield new Promise((e=>{var t,i;null===(i=null===(t=o.chromeP.storage)||void 0===t?void 0:t.local)||void 0===i||i.get(this.storageKey,(t=>e(t||{})))})),t=null==e?void 0:e[this.storageKey];t&&t.cache?(this.cache=t.cache||{},t.stats&&(this.dailyStats=t.stats)):t&&(this.cache=t||{}),this.totalSizeBytes=0;for(const e in this.cache){const t=this.cache[e];t&&(this.totalSizeBytes+=this.getEntrySize(t))}this.loaded=!0,this.loadingPromise=null,this.checkAndResetDailyStats()})))()),this.loadingPromise}))}getEntrySize(e){return null!=e.size||(e.size=this.calculateSize(e.value)),e.size}calculateSize(e){return JSON.stringify(e).length}checkAndResetDailyStats(){const e=(new Date).getDate().toString();this.dailyStats.date!==e&&(this.dailyStats={date:e,hits:0,sizeBytes:0})}queueOperation(e){return new Promise(((t,i)=>{this.operationQueue=this.operationQueue.then((()=>n(this,void 0,void 0,(function*(){try{const i=yield e();t(i)}catch(e){i(e)}})))).catch((e=>{i(e)}))}))}isExpired(e){return!e.maxAge||Date.now()>=e.maxAge}getEntriesByCreationTime(){return Object.entries(this.cache).map((([e,t])=>[e,t])).sort((([,e],[,t])=>e.maxAge-t.maxAge))}removeKey(e){const t=this.cache[e];t&&null!=t.size&&(this.totalSizeBytes-=t.size),delete this.cache[e]}getRaw(e){return n(this,void 0,void 0,(function*(){return yield this.ensureLoaded(),this.cache[e]}))}get(e){return n(this,arguments,void 0,(function*(e,t=!1){yield this.ensureLoaded(),this.checkAndResetDailyStats();const i=this.cache[e];if(i){if(!this.isExpired(i))return t&&(this.dailyStats.hits++,this.dailyStats.sizeBytes+=this.getEntrySize(i)),i.value;this.removeKey(e)}}))}set(e,t){return n(this,void 0,void 0,(function*(){return this.queueOperation((()=>n(this,void 0,void 0,(function*(){yield this.ensureLoaded();const i=this.calculateSize(t);this.removeKey(e),this.cache[e]={value:t,maxAge:Date.now()+this.ttlMs,size:i},this.totalSizeBytes+=i,this.persist()}))))}))}merge(e,t){return n(this,void 0,void 0,(function*(){return this.queueOperation((()=>n(this,void 0,void 0,(function*(){var i;yield this.ensureLoaded();const n=t(null===(i=this.cache[e])||void 0===i?void 0:i.value),o=this.calculateSize(n);return this.removeKey(e),this.cache[e]={value:n,maxAge:Date.now()+this.ttlMs,size:o},this.totalSizeBytes+=o,this.persist(),n}))))}))}delete(e){return n(this,void 0,void 0,(function*(){return this.queueOperation((()=>n(this,void 0,void 0,(function*(){yield this.ensureLoaded(),this.removeKey(e),this.persist()}))))}))}clear(){return n(this,void 0,void 0,(function*(){return this.queueOperation((()=>n(this,void 0,void 0,(function*(){yield this.ensureLoaded(),this.cache={},this.totalSizeBytes=0,this.resetDailyStats(),yield new Promise((e=>{var t,i;null===(i=null===(t=o.chromeP.storage)||void 0===t?void 0:t.local)||void 0===i||i.remove(this.storageKey,(()=>e()))}))}))))}))}resetDailyStats(){this.dailyStats={date:(new Date).getDate().toString(),hits:0,sizeBytes:0}}persist(){return n(this,void 0,void 0,(function*(){return new Promise((e=>{this.persistWaiters.push(e);const t=Date.now();null===this.firstPersistTime&&(this.firstPersistTime=t),null!=this.persistTimer&&clearTimeout(this.persistTimer);const i=t-this.firstPersistTime,n=i>=this.maxPersistWaitTime?0:Math.min(this.normalDelay,this.maxPersistWaitTime-i);this.persistTimer=setTimeout((()=>{var e,t;console.debug("persist",this.storageKey,"at",(new Date).toISOString()),this.gcIfNeeded();const i={cache:this.cache,stats:this.dailyStats};null===(t=null===(e=o.chromeP.storage)||void 0===e?void 0:e.local)||void 0===t||t.set({[this.storageKey]:i},(()=>{this.persistWaiters.splice(0).forEach((e=>e()))})),this.persistTimer=null,this.firstPersistTime=null}),n)}))}))}cleanupExpired(){const e=[];for(const t in this.cache){const i=this.cache[t];i&&!this.isExpired(i)||e.push(t)}for(const t of e)this.removeKey(t)}gcIfNeeded(){this.cleanupExpired();const e=Object.keys(this.cache);if(!(e.length>this.maxEntries||this.totalSizeBytes>this.maxSizeBytes))return;const t=this.getEntriesByCreationTime();let i=Math.max(0,e.length-this.maxEntries);for(const[e]of t)if(i>0)this.removeKey(e),i--;else{if(this.totalSizeBytes<=this.maxSizeBytes)break;this.removeKey(e)}}getCacheStats(){if(!this.loaded)return{entryCount:0,sizeBytes:0,maxEntries:this.maxEntries,maxSizeBytes:this.maxSizeBytes,dailyStats:this.dailyStats};const e=Object.keys(this.cache).length,t=this.totalSizeBytes;return this.checkAndResetDailyStats(),this.persist(),{entryCount:e,sizeBytes:t,maxEntries:this.maxEntries,maxSizeBytes:this.maxSizeBytes,dailyStats:this.dailyStats}}setMaxSizeBytes(e){this.maxSizeBytes=e}getMaxSizeBytes(){return this.maxSizeBytes}}},1398:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),i(5335);const o=i(8856),s=i(9782),r=i(1818),a=i(3916),c=i(4948),l=i(8245),u=i(9672),d=i(2044),h=i(7139),p=i(5142),m={},f={};function y(e){return n(this,void 0,void 0,(function*(){if("scripting"in chrome&&"getRegisteredContentScripts"in chrome.scripting)try{yield u.chromeP.scripting.unregisterContentScripts({ids:[e]})}catch(e){}else f[e]&&(f[e].unregister(),delete f[e])}))}chrome.runtime.onMessage.addListener(((e,t,i)=>"sendRequest"===e.message?((0,s.sendRealRequestToCustomServer)(e.type,e.url,e.data,e.headers).then(i).catch((()=>{i({responseText:"",status:-1,ok:!1})})),!0):"getHash"===e.message?((0,d.getHash)(e.value,e.times).then(i).catch((e=>{i({error:null==e?void 0:e.message})})),!0):"getVideoLabel"===e.message?((0,c.getVideoLabelBackground)(e.videoID,Boolean(e.refreshCache)).then((e=>i({category:e}))).catch((()=>i({category:null}))),!0):"getSegments"===e.message?((0,a.getSegmentsBackground)(e.videoID,e.extraRequestData||{},Boolean(e.ignoreCache)).then((e=>i({response:e}))).catch((()=>i({response:{segments:null,status:-1}}))),!0):"submitVote"===e.message?((0,l.submitVote)(e.type,e.UUID,e.category).then(i),!0):"getCacheStats"===e.message?(function(){return n(this,void 0,void 0,(function*(){return{segments:r.segmentsCache.getCacheStats(),videoLabels:r.videoLabelCache.getCacheStats()}}))}().then((e=>i({stats:e}))).catch((()=>i({stats:null}))),!0):"clearAllCache"===e.message&&((0,r.clearAllCacheBackground)().then((()=>i({ok:!0}))).catch((()=>i({ok:!1}))),!0))),(0,p.setupTabUpdates)(o.default),chrome.runtime.onMessage.addListener((function(e,t,i){var o;switch(e.message){case"openConfig":return chrome.tabs.create({url:chrome.runtime.getURL("options/options.html"+(e.hash?"#"+e.hash:""))}),!1;case"openHelp":return chrome.tabs.create({url:chrome.runtime.getURL("help/index.html")}),!1;case"openPage":return chrome.tabs.create({url:chrome.runtime.getURL(e.url)}),!1;case"registerContentScript":return function(e){n(this,void 0,void 0,(function*(){var t,i,n,o;if("scripting"in chrome&&"getRegisteredContentScripts"in chrome.scripting){const t=yield u.chromeP.scripting.getRegisteredContentScripts({ids:[e.id]}).catch((()=>[]));if(t&&t.length>0&&e.matches.every((e=>t[0].matches.includes(e))))return}yield y(e.id),"scripting"in chrome&&"getRegisteredContentScripts"in chrome.scripting?yield u.chromeP.scripting.registerContentScripts([{id:e.id,runAt:"document_start",matches:e.matches,allFrames:e.allFrames,js:e.js,css:e.css,persistAcrossSessions:!0}]):chrome.contentScripts.register({allFrames:e.allFrames,js:null===(i=null===(t=e.js)||void 0===t?void 0:t.map)||void 0===i?void 0:i.call(t,(e=>({file:e}))),css:null===(o=null===(n=e.css)||void 0===n?void 0:n.map)||void 0===o?void 0:o.call(n,(e=>({file:e}))),matches:e.matches}).then((t=>{f[e.id]=t}))}))}(e),!1;case"unregisterContentScript":return y(e.id),!1;case"tabs":return chrome.tabs.query({active:!0,currentWindow:!0},(t=>{chrome.tabs.sendMessage(t[0].id,e.data,(e=>{i(e)}))})),!0;case"time":case"infoUpdated":case"videoChanged":if(t.tab)try{null===(o=m[t.tab.id])||void 0===o||o.postMessage(e)}catch(e){}return!1;default:return!1}})),chrome.runtime.onConnect.addListener((e=>{"popup"===e.name&&chrome.tabs.query({active:!0,currentWindow:!0},(t=>{m[t[0].id]=e}))})),chrome.runtime.onInstalled.addListener((function(){setTimeout((()=>n(this,void 0,void 0,(function*(){if(!o.default.config.userID&&!o.default.local.alreadyInstalled){chrome.tabs.create({url:chrome.runtime.getURL("/help/index.html")});const e=(0,h.generateUserID)();o.default.config.userID=e,o.default.local.alreadyInstalled=!0,o.default.config.categoryPillUpdate=!0}}))),1500)}))},1818:function(e,t,i){var n,o,s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.videoLabelCache=t.rawVideoLabelCache=t.segmentsCache=t.rawSegmentsCache=void 0,t.clearAllCacheBackground=function(){return s(this,void 0,void 0,(function*(){yield Promise.all([t.segmentsCache.clear(),t.videoLabelCache.clear()])}))};const r=i(8856),a=i(9672),c=i(721),l=36e5;class u{constructor(e){this.cache=e}get(e){return s(this,arguments,void 0,(function*(e,t=!1){if(r.default.config.enableCache)return this.cache.get(e,t)}))}set(e,t){return s(this,void 0,void 0,(function*(){if(r.default.config.enableCache)return this.cache.set(e,t)}))}merge(e,t){return s(this,void 0,void 0,(function*(){if(r.default.config.enableCache)return this.cache.merge(e,t)}))}delete(e){return s(this,void 0,void 0,(function*(){return this.cache.delete(e)}))}clear(){return s(this,void 0,void 0,(function*(){return this.cache.clear()}))}getCacheStats(){return this.cache.getCacheStats()}}null===(o=null===(n=a.chromeP.storage)||void 0===n?void 0:n.local)||void 0===o||o.remove("bsb_cache_segments"),t.rawSegmentsCache=new c.PersistentTTLCache("segment_response",l,1e3,512e3),t.segmentsCache=new u(t.rawSegmentsCache),t.rawVideoLabelCache=new c.PersistentTTLCache("video_labels",l,5e3,512e3),t.videoLabelCache=new u(t.rawVideoLabelCache)},2044:function(e,t){var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};function n(e){return i(this,arguments,void 0,(function*(e,t=5e3){if(t<=0)return"";if(!("subtle"in crypto))return new Promise(((i,n)=>chrome.runtime.sendMessage({message:"getHash",value:e,times:t},(e=>{e.error?n(e.error):i(e)}))));let i=e;for(let e=0;e<t;e++){const e=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(i).buffer);i=Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return i}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=n,t.getVideoIDHash=function(e){return i(this,void 0,void 0,(function*(){return n(e,1)}))}},3916:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getSegmentsBackground=function(e){return n(this,arguments,void 0,(function*(e,t={},i=!1){var d,h,p;const{bvId:m}=(0,a.parseBvidAndCidFromVideoId)(e);if(!m)return{segments:null,status:404};const f=o.default.config.categorySelections.map((e=>e.name)),y=(yield(0,r.getVideoIDHash)(m)).slice(0,4),g=yield function(e,t,i){return n(this,void 0,void 0,(function*(){if(i)yield l.segmentsCache.delete(e);else{const t=yield l.segmentsCache.get(e,!0);if(t)return t}const n=yield(0,c.callAPI)("GET",`/api/skipSegments/${e}`,t,i);return 200!=n.status&&404!=n.status||(yield l.segmentsCache.set(e,n)),n}))}(y,t,i),v={segments:null,status:g.status};if(!(null==g?void 0:g.ok))return v;const S=JSON.parse(null==g?void 0:g.responseText);for(const e of S){const t=null===(p=null===(h=null===(d=e.segments)||void 0===d?void 0:d.filter((e=>u().includes(e.actionType)&&f.includes(e.category))))||void 0===h?void 0:h.map((e=>Object.assign(Object.assign({},e),{source:s.SponsorSourceType.Server}))))||void 0===p?void 0:p.sort(((e,t)=>e.segment[0]-t.segment[0]));m==e.videoID&&(v.segments=t)}return v}))};const o=i(8856),s=i(9209),r=i(2044),a=i(9863),c=i(9782),l=i(1818);function u(e=!1){const t=[s.ActionType.Skip,s.ActionType.Poi];return o.default.config.muteSegments&&t.push(s.ActionType.Mute),(o.default.config.fullVideoSegments||e)&&t.push(s.ActionType.Full),t}},4070:function(e,t){var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseTimeoutError=void 0,t.waitFor=function(e){return i(this,arguments,void 0,(function*(e,t=5e3,i=100,n){return yield new Promise(((o,s)=>{setTimeout((()=>{clearTimeout(a),s(`TIMEOUT waiting for ${null==e?void 0:e.toString()}: ${Error().stack}`)}),t);const r=()=>{const t=e();(n?n(t):t)&&(o(t),clearTimeout(a))};let a;const c=()=>setTimeout((()=>{r(),a=c()}),i);a=c(),r()}))}))},t.sleep=function(e){return i(this,void 0,void 0,(function*(){return yield new Promise((t=>{setTimeout(t,e)}))}))},t.objectToURI=function(e,t,i){let n=0;for(const o in t){const s=e.includes("?")||n>0?"&":i?"?":"",r="string"==typeof t[o]?t[o]:JSON.stringify(t[o]);e+=s+encodeURIComponent(o)+"="+encodeURIComponent(r),n++}return e},t.timeoutPomise=function(e){return new Promise(((t,i)=>{e&&setTimeout((()=>{i(new n)}),e)}))},t.isFirefoxOrSafari=o,t.isSafari=s,t.isFirefox=function(){return o()&&!s()};class n extends Error{constructor(e){super("Promise timed out"),this.promise=e}}function o(){return"undefined"!=typeof browser}function s(){return"undefined"!=typeof navigator&&"Apple Computer, Inc."===navigator.vendor}t.PromiseTimeoutError=n},4948:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoLabelBackground=function(e,t){return n(this,void 0,void 0,(function*(){const{bvId:i}=(0,a.parseBvidAndCidFromVideoId)(e);if(!i)return null;const u=(yield(0,r.getVideoIDHash)(i)).slice(0,4),d=yield function(e,t){return n(this,void 0,void 0,(function*(){const i=yield l.videoLabelCache.get(e,!0);if(i&&!t)return i;const o=yield function(e,t){return n(this,void 0,void 0,(function*(){const i=yield(0,c.callAPI)("GET",`/api/videoLabels/${e}`,{},t);if(!i.ok||200!==i.status)return{};const n=JSON.parse(i.responseText);return Object.fromEntries((n||[]).map((e=>{var t,i;return[e.videoID,null===(i=null===(t=e.segments)||void 0===t?void 0:t[0])||void 0===i?void 0:i.category]})).filter((([,e])=>!!e)))}))}(e,t);return yield l.videoLabelCache.set(e,o),o}))}(u,t),h=null==d?void 0:d[i];return h&&function(e){var t,i,n;const r=(null!==(i=null===(t=null===o.default||void 0===o.default?void 0:o.default.config)||void 0===t?void 0:t.categorySelections)&&void 0!==i?i:[]).find((t=>t.name===e));return(null!==(n=null==r?void 0:r.option)&&void 0!==n?n:s.CategorySkipOption.Disabled)!==s.CategorySkipOption.Disabled}(h)?h:null}))};const o=i(8856),s=i(9209),r=i(2044),a=i(9863),c=i(9782),l=i(1818)},5142:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupTabUpdates=function(e){chrome.tabs.onUpdated.addListener(o),(0,n.waitFor)((()=>null!==e.local)).then((()=>{e.local.navigationApiAvailable&&chrome.tabs.onUpdated.removeListener(o)})),e.configSyncListeners.includes(s)||e.configSyncListeners.push(s)};const n=i(4070);function o(e){chrome.tabs.sendMessage(e,{message:"update"},(()=>{chrome.runtime.lastError}))}function s(e){e.navigationApiAvailable&&(e.navigationApiAvailable.newValue?chrome.tabs.onUpdated.removeListener(o):chrome.tabs.onUpdated.addListener(o))}},5335:()=>{const e=globalThis.chrome&&new function e(t){return new Proxy(t,{get(t,i){if(t[i])return"function"!=typeof t[i]?new e(t[i]):(...e)=>new Promise(((n,o)=>{t[i](...e,(e=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message)):n(e)}))}))}})}(globalThis.chrome),t=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,i=globalThis.navigator?.userAgent.includes("Firefox/"),n=i?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,o=/^(https?|file|ftp):[/]+/;function s(...e){return 0===e.length?/$./:e.includes("<all_urls>")?o:e.includes("*://*/*")?n:new RegExp(e.map((e=>function(e){!function(e){if(!function(e){return"<all_urls>"===e||t.test(e)}(e))throw new Error(e+" is an invalid pattern, it must match "+String(t))}(e);let[,n,o="",s]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return n=n.replace("*",i?"(https?|wss?)":"https?").replaceAll(/[/]/g,"[/]"),"*"===o?o="[^/]+":o&&(o=o.replace(/^[*][.]/,"([^/]+.)*").replaceAll(/[.]/g,"[.]").replace(/[*]$/,"[^.]+")),s=s.replaceAll(/[/]/g,"[/]").replaceAll(/[.]/g,"[.]").replaceAll(/[*]/g,".*"),"^"+n+o+"("+s+")?$"}(e))).join("|"))}const r=Boolean(globalThis.chrome?.scripting);function a(e){return Array.isArray(e)?e:[e]}function c(e){return void 0===e?void 0:[e]}async function l({tabId:t,frameId:i,files:n,allFrames:o,matchAboutBlank:s,runAt:a},{ignoreTargetErrors:l}={}){const u=Promise.all(n.map((async n=>("string"==typeof n&&(n={file:n}),r?chrome.scripting.insertCSS({target:{tabId:t,frameIds:c(i),allFrames:void 0===i?o:void 0},files:"file"in n?[n.file]:void 0,css:"code"in n?n.code:void 0}):e.tabs.insertCSS(t,{...n,matchAboutBlank:s,allFrames:o,frameId:i,runAt:a??"document_start"})))));l?await h(u):await u}async function u({tabId:t,frameId:i,files:n,allFrames:o,matchAboutBlank:s,runAt:a},{ignoreTargetErrors:l}={}){const u=n.map((e=>"string"==typeof e?{file:e}:e));if(r){!function(e){if(e.some((e=>"code"in e)))throw new Error("chrome.scripting does not support injecting strings of `code`")}(u);const e=chrome.scripting.executeScript({target:{tabId:t,frameIds:c(i),allFrames:void 0===i?o:void 0},files:u.map((({file:e})=>e))});return void(l?await h(e):await e)}const d=[];for(const n of u)"code"in n&&await d.at(-1),d.push(e.tabs.executeScript(t,{...n,matchAboutBlank:s,allFrames:o,frameId:i,runAt:a}));l?await h(Promise.all(d)):await Promise.all(d)}const d=/^No frame with id \d+ in tab \d+.$|^No tab with id: \d+.$|^The tab was closed.$|^The frame was removed.$/;async function h(e){try{await e}catch(e){if(!d.test(e?.message))throw e}}const p="object"==typeof chrome&&"webNavigation"in chrome;"object"!=typeof chrome||chrome.contentScripts||(chrome.contentScripts={register:async function(t,i){const{js:n=[],css:o=[],matchAboutBlank:r,matches:c=[],excludeMatches:d,runAt:h}=t;let{allFrames:m}=t;if(p?m=!1:m&&console.warn("`allFrames: true` requires the `webNavigation` permission to work correctly: https://github.com/fregante/content-scripts-register-polyfill#permissions"),0===c.length)throw new Error("Type error for parameter contentScriptOptions (Error processing matches: Array requires at least 1 items; you have 0) for contentScripts.register.");await Promise.all(c.map((async t=>{if(!await e.permissions.contains({origins:[t]}))throw new Error("Permission denied to register a content script for "+t)})));const f=s(...c),y=s(...null!=d?d:[]),g=async(t,i,s=0)=>{f.test(t)&&!y.test(t)&&await async function(t){return e.permissions.contains({origins:[new URL(t).origin+"/*"]})}(t)&&await async function(e,t,i={}){const n=a(e);await Promise.all(n.map((async e=>async function({frameId:e,tabId:t,allFrames:i},n,o={}){const s=a(n).flatMap((n=>[l({tabId:t,frameId:e,allFrames:i,files:n.css??[],matchAboutBlank:n.matchAboutBlank??n.match_about_blank,runAt:n.runAt??n.run_at},o),u({tabId:t,frameId:e,allFrames:i,files:n.js??[],matchAboutBlank:n.matchAboutBlank??n.match_about_blank,runAt:n.runAt??n.run_at},o)]));await Promise.all(s)}(function(e){return"object"==typeof e?{...e,allFrames:!1}:{tabId:e,frameId:void 0,allFrames:!0}}(e),t,i))))}({tabId:i,frameId:s},{css:o,js:n,matchAboutBlank:r,runAt:h},{ignoreTargetErrors:!0})},v=async(e,{status:t},{url:i})=>{"loading"===t&&i&&g(i,e)},S=async({tabId:e,frameId:t,url:i})=>{g(i,e,t)};p?chrome.webNavigation.onCommitted.addListener(S):chrome.tabs.onUpdated.addListener(v);const b={async unregister(){p?chrome.webNavigation.onCommitted.removeListener(S):chrome.tabs.onUpdated.removeListener(v)}};return"function"==typeof i&&i(b),b}})},7139:(e,t)=>{function i(e){const t=e.replace(/__MSG_(\w+)__/g,(function(e,t){return t?chrome.i18n.getMessage(t).replace(/</g,"&#60;").replace(/"/g,"&quot;").replace(/\n/g,"<br/>"):""}));return t!=e&&t}Object.defineProperty(t,"__esModule",{value:!0}),t.generateUserID=function(e=36){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let i="";const n="undefined"==typeof window?crypto:window.crypto;if(n&&n.getRandomValues){const o=new Uint32Array(e);n.getRandomValues(o);for(let n=0;n<e;n++)i+=t[o[n]%62];return i}for(let n=0;n<e;n++)i+=t[Math.floor(62*Math.random())];return i},t.localizeHtmlPage=function(){const e=i(document.title);e&&(document.title=e);const t=document.querySelector(".sponsorBlockPageBody"),n=i(t.innerHTML.toString());n&&(t.innerHTML=n)},t.getLocalizedMessage=i},8245:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.submitVote=function(e,t,i){return n(this,void 0,void 0,(function*(){let n=o.default.config.userID;null!=n&&"undefined"!==n||(n=(0,s.generateUserID)(),o.default.config.userID=n);const a=void 0!==e?"&type="+e:"&category="+i;try{const e=yield(0,r.callAPI)("POST","/api/voteOnSponsorTime?UUID="+t+"&userID="+n+a);return e.ok?{successType:1,responseText:e.responseText}:405==e.status?{successType:0,statusCode:e.status,responseText:e.responseText}:{successType:-1,statusCode:e.status,responseText:e.responseText}}catch(e){return console.error(e),{successType:-1,statusCode:-1,responseText:""}}}))};const o=i(8856),s=i(7139),r=i(9782)},8272:e=>{e.exports=JSON.parse('{"serverAddress":"https://www.bsbsb.top","testingServerAddress":"http://127.0.0.1:9876","serverAddressComment":"This specifies the default SponsorBlock server to connect to","categoryList":["sponsor","selfpromo","exclusive_access","interaction","poi_highlight","intro","outro","preview","padding","filler","music_offtopic"],"categorySupport":{"sponsor":["skip","mute","full"],"selfpromo":["skip","mute","full"],"exclusive_access":["full"],"interaction":["skip","mute"],"intro":["skip","mute"],"outro":["skip","mute"],"preview":["skip","mute"],"filler":["skip","mute"],"music_offtopic":["skip"],"poi_highlight":["poi"],"padding":["skip"]},"wikiLinks":{"sponsor":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Sponsor","selfpromo":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Unpaid%20Self%20Promotion","exclusive_access":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Full%20Video%20Labels#%E6%9F%94%E6%80%A7%E6%8E%A8%E5%B9%BF%E5%93%81%E7%89%8C%E5%90%88%E4%BD%9C","interaction":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Interaction%20Reminder%20(Subscribe)","intro":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Intermission%20Intro%20Animation","outro":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Endcards%20Credits%20(Outro)","preview":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Preview%20Recap%20Hook","filler":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Tangents%20Jokes","music_offtopic":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Music%20Non-Music%20Section","poi_highlight":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/HighLight","guidelines":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Submitting%20tips","mute":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Mute%20Segment","padding":"https://github.com/hanydd/BilibiliSponsorBlock/wiki/Sponsor"}}')},8856:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(8272),o=i(9209),s=i(9205);class r extends s.ProtoConfig{resetToDefault(){chrome.storage.sync.set(Object.assign(Object.assign({},this.syncDefaults),{userID:this.config.userID,minutesSaved:this.config.minutesSaved,skipCount:this.config.skipCount,sponsorTimesContributed:this.config.sponsorTimesContributed})),chrome.storage.local.set(Object.assign({},this.localDefaults))}}const a={userID:null,isVip:!1,permissions:{},defaultCategory:"chooseACategory",renderSegmentsAsChapters:!1,whitelistedChannels:[],forceChannelCheck:!1,minutesSaved:0,skipCount:0,sponsorTimesContributed:0,submissionCountSinceCategories:0,showTimeWithSkips:!0,disableSkipping:!1,enableDanmakuSkip:!1,enableAutoSkipDanmakuSkip:!1,enableMenuDanmakuSkip:!1,danmakuOffsetMatchingRegexPattern:"(?:^|(å³|å³æ»‘|æŒ‰|å³ä¸‹|å³å‘|å³æ–¹å‘|â†’|â‡’|â‡¢|â‡¨|â®•|ðŸ¡†|ðŸ º|ðŸ ¾|ðŸ¢’|ðŸ‘‰))(\\d+)(ä¸‹|æ¬¡)?",checkTimeDanmakuSkip:!0,muteSegments:!0,fullVideoSegments:!0,fullVideoLabelsOnThumbnailsMode:o.HideFullVideoLabels.Overlay,manualSkipOnFullVideo:!1,trackViewCount:!0,trackViewCountInPrivate:!0,trackDownvotes:!0,trackDownvotesInPrivate:!1,dontShowNotice:!1,noticeVisibilityMode:o.NoticeVisibilityMode.FadedForAutoSkip,hideVideoPlayerControls:!1,hideInfoButtonPlayerControls:!1,hideDeleteButtonPlayerControls:!1,hideUploadButtonPlayerControls:!1,hideSkipButtonPlayerControls:!1,hideDiscordLaunches:0,hideDiscordLink:!1,invidiousInstances:["invidious.snopyta.org"],serverAddress:n.serverAddress,minDuration:0,skipNoticeDuration:4,skipNoticeDurationBefore:3,advanceSkipNotice:!1,audioNotificationOnSkip:!1,checkForUnlistedVideos:!1,testingServer:!1,ytInfoPermissionGranted:!1,allowExperiments:!0,showDonationLink:!0,showPopupDonationCount:0,showNewFeaturePopups:!0,donateClicked:0,autoHideInfoButton:!0,autoSkipOnMusicVideos:!1,scrollToEditTimeUpdate:!1,categoryPillUpdate:!1,showChapterInfoMessage:!0,darkMode:!0,showCategoryGuidelines:!0,showShortcutPopover:!0,showCategoryWithoutPermission:!1,showSegmentNameInChapterBar:!0,useVirtualTime:!0,showSegmentFailedToFetchWarning:!0,allowScrollingToEdit:!0,showPreviewYoutubeButton:!0,showPortVideoButton:!0,cleanPopup:!1,enableCache:!0,dynamicAndCommentSponsorWhitelistedChannels:!1,dynamicAndCommentSponsorBlocker:!1,dynamicAndCommentSponsorRegexPattern:"/618|11(?!1).11(?:æ—¥)?|åŒ(?:11|åä¸€|12|åäºŒ)|å¥³ç¥žèŠ‚|å¼€å­¦å­£|å¹´è´§èŠ‚|æ°(?:ä¸ª|äº†|åˆ°)?é¥­|é‡‘ä¸»|(ä»–|å®ƒ|å¥¹)(?:ä»¬)?å®¶(?:çš„)?|(?:è¯„è®ºåŒº)?(?:é¢†(?:å–|å¼ |åˆ°)?|æŠ¢|é€|å¾—|å )(?:æˆ‘çš„)?(?:ç¥ž|ä¼˜æƒ |çº¢åŒ…|æŠ˜æ‰£|ç¦åˆ©|æ— é—¨æ§›|éšè—|ç§˜å¯†|ä¸“å±ž|(?:è¶…)?å¤§(?:é¢)?|é¢å¤–)+(?:åˆ¸|å·|åŠµ|q(?:uan)?)?(?:åŽ|åˆ°æ‰‹|ä»·|ä½¿ç”¨|ä¸‹å•)?|(?:é¢†|æŠ¢|å¾—|é€)(?:çº¢åŒ…|ä¼˜æƒ |åˆ¸|ç¦åˆ©)|(?:ä¼˜æƒ |(?:åˆ¸|å·|åŠµ)åŽ|åˆ°æ‰‹|ä¿ƒé”€|æ´»åŠ¨|ç¥ž)ä»·|(?:æ·˜å®|tb|äº¬ä¸œ|jd|ç‹—ä¸œ|æ‹¼å¤šå¤š|pdd|å¤©çŒ«|tmall)æœç´¢|(?:éš(ä¾¿|æ—¶)|ä»»æ„)(?:é€€|é€€è´§|æ¢è´§)|(?:å…è´¹|æ— å¿)(?:æ¢(?:ä¸ª)?æ–°|æ›¿æ¢|æ›´æ¢|è¯•ç”¨)(?:å•†å“|ç‰©å“)?|(?:ç‚¹(?:å‡»)?|æˆ³|æ¥|æˆ‘)è¯„è®ºåŒº(?:ç½®é¡¶)?|(?:ç«‹å³|è“é“¾|é“¾æŽ¥|ðŸ”—)(?:è´­ä¹°|ä¸‹å•)|(?:vx|wx|å¾®ä¿¡|è½¯ä»¶)æ‰«ç (?:é¢†)?(?:ä¼˜æƒ |çº¢åŒ…|åˆ¸)?|(?:æˆ‘çš„)?åŒæ¬¾(?:[çš„]?(?:æŽ¨è|å¥½ç‰©|å•†å“|å…¥æ‰‹|è´­ä¹°|æ‹¥æœ‰|åˆ†äº«|å®‰åˆ©)?)|æ»¡\\d+|å¤§ä¿ƒ|ä¿ƒé”€|æŠ˜æ‰£|ç‰¹ä»·|ç§’æ€|å¹¿å‘Š|æŽ¨å¹¿|ä½Žè‡³|çƒ­å–|æŠ¢è´­|æ–°å“|è±ªç¤¼|èµ å“|å¯†ä»¤|(?:é¥¿äº†ä¹ˆ|ç¾Ž(?:å›¢|å›£)|ç™¾åº¦å¤–å–|èœ‚é¸Ÿ|è¾¾è¾¾|UUè·‘è…¿|(?:æ·˜å®)?é—ªè´­)|(?:ç‚¹|è®¢|é€|åƒ)(?:å¤–å–|é¤)|å¤–å–(?:èŠ‚|æœåŠ¡|å¹³å°|app)/gi",dynamicAndCommentSponsorRegexPatternKeywordNumber:1,dynamicSponsorBlock:!0,dynamicSponsorBlockerDebug:!1,dynamicSpaceSponsorBlocker:!1,commentSponsorBlock:!0,commentSponsorReplyBlock:!1,showNewIcon:!0,categoryPillColors:{},skipKeybind:{key:"Enter"},skipToHighlightKeybind:{key:"Enter",ctrl:!0},startSponsorKeybind:{key:";"},submitKeybind:{key:"'"},actuallySubmitKeybind:{key:"'",ctrl:!0},previewKeybind:{key:";",ctrl:!0},nextFrameKeybind:{key:"."},previousFrameKeybind:{key:","},closeSkipNoticeKeybind:{key:"Backspace"},categorySelections:[{name:"sponsor",option:o.CategorySkipOption.AutoSkip},{name:"selfpromo",option:o.CategorySkipOption.ManualSkip},{name:"interaction",option:o.CategorySkipOption.ManualSkip},{name:"intro",option:o.CategorySkipOption.ManualSkip},{name:"outro",option:o.CategorySkipOption.ManualSkip},{name:"preview",option:o.CategorySkipOption.ShowOverlay},{name:"padding",option:o.CategorySkipOption.AutoSkip},{name:"music_offtopic",option:o.CategorySkipOption.AutoSkip},{name:"poi_highlight",option:o.CategorySkipOption.ManualSkip},{name:"exclusive_access",option:o.CategorySkipOption.ShowOverlay}],payments:{licenseKey:null,lastCheck:0,lastFreeCheck:0,freeAccess:!1,chaptersAllowed:!1},colorPalette:{red:"#780303",white:"#ffffff",locked:"#ffc83d"},barTypes:{"preview-chooseACategory":{color:"#ffffff",opacity:"0.7"},sponsor:{color:"#00d400",opacity:"0.7"},"preview-sponsor":{color:"#007800",opacity:"0.7"},selfpromo:{color:"#ffff00",opacity:"0.7"},"preview-selfpromo":{color:"#bfbf35",opacity:"0.7"},exclusive_access:{color:"#008a5c",opacity:"0.7"},interaction:{color:"#cc00ff",opacity:"0.7"},"preview-interaction":{color:"#6c0087",opacity:"0.7"},intro:{color:"#00ffff",opacity:"0.7"},"preview-intro":{color:"#008080",opacity:"0.7"},outro:{color:"#0202ed",opacity:"0.7"},"preview-outro":{color:"#000070",opacity:"0.7"},preview:{color:"#008fd6",opacity:"0.7"},"preview-preview":{color:"#005799",opacity:"0.7"},music_offtopic:{color:"#ff9900",opacity:"0.7"},"preview-music_offtopic":{color:"#a6634a",opacity:"0.7"},poi_highlight:{color:"#ff1684",opacity:"0.7"},"preview-poi_highlight":{color:"#9b044c",opacity:"0.7"},filler:{color:"#7300FF",opacity:"0.9"},"preview-filler":{color:"#2E0066",opacity:"0.7"},padding:{color:"#222222",opacity:"0.7"},"preview-padding":{color:"#111111",opacity:"0.7"}},dynamicSponsorSelections:[{name:"dynamicSponsor_sponsor",option:o.DynamicSponsorOption.Hide},{name:"dynamicSponsor_forward_sponsor",option:o.DynamicSponsorOption.Hide},{name:"dynamicSponsor_suspicion_sponsor",option:o.DynamicSponsorOption.Disabled}],dynamicSponsorTypes:{dynamicSponsor_sponsor:{color:"#007800",opacity:"0.7"},dynamicSponsor_forward_sponsor:{color:"#bfbf35",opacity:"0.7"},dynamicSponsor_suspicion_sponsor:{color:"#a6634a",opacity:"0.7"}}},c=new r(a,{downvotedSegments:{},navigationApiAvailable:null,alreadyInstalled:!1,unsubmittedSegments:{}},(function(e){const t=["skipKeybind","startSponsorKeybind","submitKeybind"];for(let i=t.length-1;i>=0;i--)for(let n=0;n<t.length;n++)i!=n&&(0,s.keybindEquals)(e[t[i]],e[t[n]])&&(e[t[i]]=null);e.serverAddress.includes("47.103.74.95")&&(e.serverAddress=n.serverAddress),e.serverAddress.includes("115.190.32.254")&&(e.serverAddress=n.serverAddress),delete e.danmakuRegexPattern,delete e.danmakuTimeMatchingRegexPattern,["(?:^|(å³|å³æ»‘|æŒ‰|å³ä¸‹|å³å‘|å³æ–¹å‘|â†’|â‡’|â‡¢|â‡¨|â®•|ðŸ¡†|ðŸ º|ðŸ ¾|ðŸ¢’|ðŸ‘‰))(\\d+)(ä¸‹|æ¬¡)?$"].includes(e.danmakuOffsetMatchingRegexPattern)&&(e.danmakuOffsetMatchingRegexPattern=a.danmakuOffsetMatchingRegexPattern),e.dynamicSponsorRegexPattern&&!e.dynamicAndCommentSponsorRegexPattern&&(e.dynamicAndCommentSponsorRegexPattern=e.dynamicSponsorRegexPattern,delete e.dynamicSponsorRegexPattern),["(618|11(?!1).11|åŒ(11|åä¸€|12|åäºŒ))|æ°(?:ä¸ª|äº†|åˆ°)?é¥­|((é¢†(?:å–)?|æŠ¢|æœ‰)(?:ç¥ž|ä¼˜æƒ )?åˆ¸|åˆ¸åŽ)|(æ·˜å®|äº¬ä¸œ|æ‹¼å¤šå¤š)æœç´¢|(ç‚¹(?:å‡»)|æˆ³|æ¥|æˆ‘)è¯„è®ºåŒº(?:ç½®é¡¶)|(ç«‹å³|è“é“¾)(?:è´­ä¹°|ä¸‹å•)|æ»¡\\d+|(å¤§ä¿ƒ|ä¿ƒé”€)|æŠ˜æ‰£|ç‰¹ä»·|ç§’æ€|å¹¿å‘Š|ä½Žè‡³|çƒ­å–|æŠ¢è´­|æ–°å“|è±ªç¤¼|èµ å“","(618|11(?!1).11|åŒ(11|åä¸€|12|åäºŒ))|(æ°|æŽ¥)(?:ä¸ª|äº†|åˆ°)?(é¥­|å¹¿)|((?:é¢†(?:å–|å¼ )?|æŠ¢|æœ‰)(?:ç¥ž|ä¼˜æƒ )?(åˆ¸|å·)|åˆ¸åŽ|å·åŽ)|(æ·˜å®|äº¬ä¸œ|æ‹¼å¤šå¤š)æœç´¢|(ç‚¹(?:å‡»)|æˆ³|æ¥|æˆ‘)è¯„è®ºåŒº(?:ç½®é¡¶)|(ç«‹å³|è“é“¾)(?:è´­ä¹°|ä¸‹å•)|æ»¡\\d+|(å¤§ä¿ƒ|ä¿ƒé”€)|æŠ˜æ‰£|ç‰¹ä»·|ç§’æ€|å¹¿å‘Š|ä½Žè‡³|çƒ­å–|æŠ¢è´­|æ–°å“|è±ªç¤¼|èµ å“|åŒæ¬¾","/(618|11(?!1).11|åŒ(?:11|åä¸€|12|åäºŒ)|å¥³ç¥žèŠ‚)|æ°(?:ä¸ª|äº†|åˆ°)?é¥­|é‡‘ä¸»|(?:è¯„è®ºåŒº)?(?:é¢†(?:å–|å¼ |åˆ°)?|æŠ¢|æœ‰|é€|å¾—)(?:æˆ‘çš„)?(?:ç¥ž|ä¼˜æƒ |çº¢åŒ…|æŠ˜æ‰£|ç¦åˆ©|æ— é—¨æ§›|éšè—|ç§˜å¯†|ä¸“å±ž|(?:è¶…)?å¤§(?:é¢)?|é¢å¤–)*(?:åˆ¸|å·|åŠµ|q(?:uan)?)?(?:åŽ|åˆ°æ‰‹|ä»·|ä½¿ç”¨|ä¸‹å•)?|(?:ä¼˜æƒ |(?:åˆ¸|å·|åŠµ)åŽ|åˆ°æ‰‹|ä¿ƒé”€|æ´»åŠ¨|ç¥ž)ä»·|(?:æ·˜å®|tb|äº¬ä¸œ|jd|ç‹—ä¸œ|æ‹¼å¤šå¤š|pdd|å¤©çŒ«|tmall)æœç´¢|(?:éš(ä¾¿|æ—¶)|ä»»æ„)(?:é€€|é€€è´§|æ¢è´§)|(?:å…è´¹|æ— å¿)(?:æ¢(?:ä¸ª)?æ–°|æ›¿æ¢|æ›´æ¢)(?:å•†å“|ç‰©å“)?|(?:ç‚¹(?:å‡»)?|æˆ³|æ¥|æˆ‘)è¯„è®ºåŒº(?:ç½®é¡¶)?|(?:ç«‹å³|è“é“¾|é“¾æŽ¥|ðŸ”—)(?:è´­ä¹°|ä¸‹å•)|(?:vx|wx|å¾®ä¿¡|è½¯ä»¶)æ‰«ç (?:é¢†)?(?:ä¼˜æƒ |çº¢åŒ…|åˆ¸)?|(?:æˆ‘çš„)?åŒæ¬¾(?:[çš„]?(?:æŽ¨è|å¥½ç‰©|å•†å“|å…¥æ‰‹|è´­ä¹°|æ‹¥æœ‰|åˆ†äº«|å®‰åˆ©)?)|æ»¡\\d+|å¤§ä¿ƒ|ä¿ƒé”€|æŠ˜æ‰£|ç‰¹ä»·|ç§’æ€|å¹¿å‘Š|æŽ¨å¹¿|ä½Žè‡³|çƒ­å–|æŠ¢è´­|æ–°å“|è±ªç¤¼|èµ å“/gi"].includes(e.dynamicAndCommentSponsorRegexPattern)&&(e.dynamicAndCommentSponsorRegexPattern=a.dynamicAndCommentSponsorRegexPattern),e.whitelistedChannels&&e.whitelistedChannels.length>0&&"string"==typeof e.whitelistedChannels[0]&&(e.whitelistedChannels=e.whitelistedChannels.map((e=>({id:e,name:chrome.i18n.getMessage("whitelistUnknownUploader")||"Unknown UP"})))),e.dynamicSponsorBlocker&&(e.dynamicAndCommentSponsorBlocker=e.dynamicSponsorBlocker,delete e.dynamicSponsorBlocker),e.dynamicSponsorWhitelistedChannels&&(e.dynamicAndCommentSponsorWhitelistedChannels=e.dynamicSponsorWhitelistedChannels,delete e.dynamicSponsorWhitelistedChannels),e.fullVideoLabelsOnThumbnails&&(!0===e.fullVideoLabelsOnThumbnails?e.fullVideoLabelsOnThumbnailsMode=o.HideFullVideoLabels.Overlay:e.fullVideoLabelsOnThumbnailsMode=o.HideFullVideoLabels.Disabled,delete e.fullVideoLabelsOnThumbnails)}));t.default=c},9205:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoConfig=void 0,t.keybindEquals=function(e,t){return!(null==e||null==t||Boolean(e.alt)!=Boolean(t.alt)||Boolean(e.ctrl)!=Boolean(t.ctrl)||Boolean(e.shift)!=Boolean(t.shift)||null==e.key&&null==e.code||null==t.key&&null==t.code)&&(null!=e.code&&null!=t.code?e.code===t.code:null!=e.key&&null!=t.key&&e.key.toUpperCase()===t.key.toUpperCase())},t.formatKey=s,t.keybindToString=function(e){if(null==e||null==e.key)return"";let t="";return e.ctrl&&(t+="Ctrl + "),e.alt&&(t+="Alt + "),e.shift&&(t+="Shift + "),t+s(e.key)};const o=i(4070);function s(e){return null==e?"":" "==e?"Space":1==e.length?e.toUpperCase():e}t.ProtoConfig=class{constructor(e,t,i,n=!1){this.configLocalListeners=[],this.configSyncListeners=[],this.cachedSyncConfig=null,this.cachedLocalStorage=null,this.config=null,this.local=null,this.inDeArrow=!1,this.syncDefaults=e,this.localDefaults=t,this.inDeArrow=n,this.setupConfig(i).then((e=>{this.config=null==e?void 0:e.sync,this.local=null==e?void 0:e.local}))}configProxy(){chrome.storage.onChanged.addListener(((e,t)=>{if("sync"===t){for(const t in e)this.cachedSyncConfig[t]=e[t].newValue;for(const t of this.configSyncListeners)t(e)}else if("local"===t){for(const t in e)t.startsWith("bsb_cache")||(this.cachedLocalStorage[t]=e[t].newValue);for(const t of this.configLocalListeners)t(e)}}));let e=0;const t=new Set;let i=null;const n=this,o={set(o,s,r){if(n.cachedSyncConfig[s]=r,Date.now()-e<100){if(t.add(s),!i){const e=()=>{const e=[...t];t.clear(),chrome.storage.sync.set(e.map((e=>[e,n.cachedSyncConfig[e]])).reduce(((e,[t,i])=>(e[t]=i,e)),{})),i=null};i=setTimeout(e,20)}return!0}return chrome.storage.sync.set({[s]:r}),e=Date.now(),!0},get(e,t){const i=n.cachedSyncConfig[t];return e[t]||i},deleteProperty:(e,t)=>(chrome.storage.sync.remove(t),!0)},s={set:(e,t,i)=>(n.cachedLocalStorage[t]=i,chrome.storage.local.set({[t]:i}),!0),get(e,t){const i=n.cachedLocalStorage[t];return e[t]||i},deleteProperty:(e,t)=>(chrome.storage.local.remove(t),!0)};return{sync:new Proxy({handler:o},o),local:new Proxy({handler:s},s)}}forceSyncUpdate(e){const t=this.cachedSyncConfig[e];chrome.storage.sync.set({[e]:t})}forceLocalUpdate(e){const t=this.cachedLocalStorage[e];chrome.storage.local.set({[e]:t},(()=>{chrome.runtime.lastError&&alert(chrome.i18n.getMessage("storageFull"))}))}fetchConfig(){return n(this,void 0,void 0,(function*(){yield Promise.all([new Promise((e=>{chrome.storage.sync.get(null,(t=>{this.cachedSyncConfig=t,void 0===this.cachedSyncConfig&&(this.cachedSyncConfig={},(this.inDeArrow||window.location.href.includes("options.html"))&&alert(`${chrome.i18n.getMessage("syncDisabledWarning")}${this.inDeArrow?`\n\n${chrome.i18n.getMessage("syncDisabledWarningDeArrow")}`:""}${(0,o.isFirefox)()?`\n\n${chrome.i18n.getMessage("syncDisabledFirefoxSuggestions")}`:""}`)),e()}))})),new Promise((e=>{chrome.storage.local.get(null,(t=>{this.cachedLocalStorage=null!=t?t:{},e()}))}))])}))}setupConfig(e){return n(this,void 0,void 0,(function*(){if("undefined"==typeof chrome)return null;yield this.fetchConfig(),this.addDefaults();const t=this.configProxy();return e(t.sync),t}))}addDefaults(){for(const e in this.syncDefaults)if(Object.prototype.hasOwnProperty.call(this.cachedSyncConfig,e)){if("barTypes"===e)for(const t in this.syncDefaults[e])Object.prototype.hasOwnProperty.call(this.cachedSyncConfig[e],t)||(this.cachedSyncConfig[e][t]=this.syncDefaults[e][t])}else this.cachedSyncConfig[e]=this.syncDefaults[e];for(const e in this.localDefaults)Object.prototype.hasOwnProperty.call(this.cachedLocalStorage,e)||(this.cachedLocalStorage[e]=this.localDefaults[e])}isReady(){return null!==this.config}}},9209:(e,t)=>{var i,n,o,s,r,a,c,l,u;Object.defineProperty(t,"__esModule",{value:!0}),t.HideFullVideoLabels=t.NoticeVisibilityMode=t.ChannelIDStatus=t.SponsorSourceType=t.ActionTypes=t.ActionType=t.SponsorHideType=t.DynamicSponsorOption=t.CategorySkipOption=t.PageType=void 0,function(e){e.Unknown="unknown",e.Main="main",e.History="history",e.OldHistory="oldHistory",e.Video="video",e.List="list",e.Search="search",e.Dynamic="dynamic",e.Channel="channel",e.Message="message",e.Manga="manga",e.Anime="bangumi",e.Live="live",e.Opus="opus",e.Embed="embed"}(i||(t.PageType=i={})),function(e){e[e.Disabled=-1]="Disabled",e[e.ShowOverlay=0]="ShowOverlay",e[e.ManualSkip=1]="ManualSkip",e[e.AutoSkip=2]="AutoSkip"}(n||(t.CategorySkipOption=n={})),function(e){e[e.Disabled=0]="Disabled",e[e.ShowOverlay=1]="ShowOverlay",e[e.Hide=2]="Hide"}(o||(t.DynamicSponsorOption=o={})),function(e){e[e.Visible=void 0]="Visible",e[e.Downvoted=1]="Downvoted",e[e.MinimumDuration=2]="MinimumDuration",e[e.Hidden=3]="Hidden"}(s||(t.SponsorHideType=s={})),function(e){e.Skip="skip",e.Mute="mute",e.Full="full",e.Poi="poi"}(r||(t.ActionType=r={})),t.ActionTypes=[r.Skip,r.Mute,r.Full,r.Poi],function(e){e[e.Server=void 0]="Server",e[e.Local=1]="Local",e[e.YouTube=2]="YouTube",e[e.Danmaku=3]="Danmaku"}(a||(t.SponsorSourceType=a={})),function(e){e[e.Fetching=0]="Fetching",e[e.Found=1]="Found",e[e.Failed=2]="Failed"}(c||(t.ChannelIDStatus=c={})),function(e){e[e.FullSize=0]="FullSize",e[e.MiniForAutoSkip=1]="MiniForAutoSkip",e[e.MiniForAll=2]="MiniForAll",e[e.FadedForAutoSkip=3]="FadedForAutoSkip",e[e.FadedForAll=4]="FadedForAll"}(l||(t.NoticeVisibilityMode=l={})),function(e){e[e.Disabled=0]="Disabled",e[e.Overlay=1]="Overlay",e[e.Hide=2]="Hide",e[e.BlurRevealOnHover=3]="BlurRevealOnHover",e[e.BlurAlways=4]="BlurAlways",e[e.SolidCover=5]="SolidCover"}(u||(t.HideFullVideoLabels=u={}))},9672:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chromeP=void 0,t.chromeP="undefined"==typeof browser?"undefined"!=typeof chrome?chrome:null:browser},9782:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendRealRequestToCustomServer=a,t.callAPI=function(e,t){return n(this,arguments,void 0,(function*(e,t,i={},n=!1,r={}){const c=`${s.default.config.testingServer?o.testingServerAddress:s.default.config.serverAddress}${t}`;return n&&(r["X-SKIP-CACHE"]="1",r["cache-control"]="no-cache"),yield a(e,c,i,r)}))};const o=i(8272),s=i(8856),r=i(4070);function a(e,t){return n(this,arguments,void 0,(function*(e,t,i={},n={}){"get"===e.toLowerCase()&&(t=(0,r.objectToURI)(t,i,!0),i=null);const o=Object.assign({},n);i&&(o["Content-Type"]="application/json"),Object.keys(n).length>0&&(o["X-EXT-VERSION"]=chrome.runtime.getManifest().version);const s=yield fetch(t,{method:e,headers:o,redirect:"follow",body:i?JSON.stringify(i):null});return(null==s?void 0:s.ok)?{responseText:yield s.text(),status:s.status,ok:s.ok}:{responseText:yield s.text(),status:s.status,ok:!1}}))}},9863:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseBvidAndCidFromVideoId=function(e){if(!e)return{bvId:null,cid:null};const[t,i=null]=e.split("+");return{bvId:t,cid:i}}}},t={};!function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}(1398)})();